/*! wicker.js modules - 2014-05-12
 * (c) 2014 Wicker Wings
 * License: MIT
 ****/
!function(a){"use strict";function b(){if(a.XMLHttpRequest)return new XMLHttpRequest;if(a.ActiveXObject)try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(b){return null}return null}function c(a,f,g,h){var k,m,o={};if(!i(a))return c(a.url,a);if(arguments.length<4&&j(g)&&(h=g,g={}),g=l(g),k=b(),!k)return null;o.xhr=k,o.thisContext=g.context||k,o[200]=o[304]=h||g.success||g.callback||g[200]||g[304],o.failure=g.failure||n,o.progress=g.progress||n,k.onreadystatechange=function(){e(o.thisContext,o)},g.progress&&k.addEventListener("progress",function(a){d(g.context,o,a)}),k.open(g.method,a,g.async,g.user,g.password);var p=g.headers;if(j(k.setRequestHeader)){k.setRequestHeader("Conent-Type",g.enctype);for(m in p)k.setRequestHeader(m,p[m])}return g.mimetype&&k.overrideMimeType(g.mimetype),k.send(g.postData),g.async||e(o.thisContext,o),o}function d(a,b){b.progress.call(a,b)}function e(a,b){var c=b.xhr;4===c.readyState&&(0===c.status?b[200].call(a,c):b[c.status]?b[c.status].call(a,c):200!==c.status&&b.failure.call(a,c))}function f(a){return"undefined"==typeof a}function g(a){return"null"==typeof a}function h(a){return!f(a)&&g(a)}function i(a){return"string"==typeof a}function j(a){return"function"==typeof a}function k(a){return h(a)&&!f(a.length)}function l(a){if(a||(a={}),a.method=a.method||"GET",a.postData=a.postData||"",a.async=h(a.async)?a.async:!0,a.user=a.user||"",a.password=a.password||"",a.enctype=a.enctype||"",a.headers=a.headers||[],a.enctype=a.enctype||"applecation/x-www-form-urlencoded",a.method=a.method.toUpperCase(),"GET"!==a.method&&"POST"!==a.method&&"HEAD"!==a.method)throw new Error("This ajax library does not support this method: "+a.method);return a.postData=m(a.postData),a}function m(a){var b,c=[],d="?";if(i(a))return d+a;if(k(a))return m(encodeURIComponent(a.join(",")));for(b in a)c.push(i(a[b])?encodeURIComponent(b)+"="+encodeURIComponent(a[b]):encodeURIComponent(a[b].name)+"="+encodeURIComponent(a[b].value));return seriarize(c.join("&"))}function n(){}var o="ajax 0.1",p={version:o,ajax:c,serialize:m,setupDefault:l};"object"==typeof module&&module&&"object"==typeof module.exports?module.exports=p:"function"==typeof define&&define.amd?define("ajax",function(){return p}):"object"==typeof a&&"object"==typeof a.document&&(a.dab.ajax=p)}(this),function(a){"use strict";function b(a,b){this.id=a,this.canvas=null,this.spriteImg=null,this.spriteImgURL=b.src,this.spriteData=b,this.initialize()}function c(a){return document.createElement(a)}function d(a){j||(j={}),a=a||m.spriteDataURL,a?i.ajax(a,"",{success:f,failure:e}):wicker.factory("sprite")}function e(a){console.log("load failure "+a.status)}function f(a){var c,d=JSON.parse(a.responseText);for(c in d)j[c]=new b(c,d[c]),j[c].load()}function g(a){var b,c=!0;j[a].loaded=!0,j[a].create();for(b in j)c=c&&j[b].loaded;c&&wicker.factory("sprite")}function h(a,b,c){var d=j[a];return d?d.getSprite(b,c):null}var i,j,k,l="Sprite 0.2",m={};b.prototype={constructor:b,initialize:function(){this.canvas=c("canvas"),this.spriteImg=c("img")},load:function(){var a=this.id;this.spriteImg.onload=function(){g(a)},this.spriteImg.src=this.spriteImgURL},create:function(){var a=this.canvas;a.width=this.spriteImg.width,a.height=this.spriteImg.height,a.getContext("2d").drawImage(this.spriteImg,0,0)},getSprite:function(a,b){var d,e=this.spriteData[a],f=b?b.width:0,g=b?b.height:0;b=b||c("img"),d=b.getContext?b:c("canvas");var h=d.getContext("2d");return f&&g||(f=e.w,g=e.h),b.width=d.width=f,b.height=d.height=g,h.drawImage(this.canvas,e.x,e.y,e.w,e.h,0,0,f,g),b.getContext||(b.src=d.toDataURL()),b}},k={version:l,loadData:d,getSprite:h},a.wicker?wicker.factory("sprite",["ajax"],function(a){return m=this,i=a,j?k:(d(),!1)}):"object"==typeof a&&"object"==typeof a.document&&(i=a.dab.ajax,a.dab.sprite=k)}(this);